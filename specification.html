<!-- Heavily based on https://github.com/jothepro/doxygen-awesome-css/blob/main/doxygen-custom/header.html -->
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=9" />
    <meta name="generator" content="Doxygen 1.9.8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- BEGIN opengraph metadata -->
    <meta property="og:title" content=Netspeak />
    <meta property="og:image" content="netspeak_logo.svg" />
    <meta property="og:description" content="One word leads to another." />
    <meta property="og:url" content="https://github.com/netspeak/netspeak4-application-ngrams" />
    <!-- END opengraph metadata -->
    <!-- BEGIN twitter metadata -->
    <meta name="twitter:image:src" content="netspeak_logo.svg" />
    <meta name="twitter:title" content="Netspeak" />
    <meta name="twitter:description" content="One word leads to another." />
    <!-- END twitter metadata -->
    <title>Netspeak: Specification</title>
    <link href="tabs.css" rel="stylesheet" type="text/css" />
    <link rel="icon" type="image/svg+xml" href="netspeak_logo.svg" />
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
    <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
    <script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
    <script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
    <script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
    <script type="text/javascript" src="toggle-alternative-theme.js"></script>
    <script type="text/javascript">
        DoxygenAwesomeFragmentCopyButton.init()
        DoxygenAwesomeDarkModeToggle.init()
        DoxygenAwesomeParagraphLink.init()
        DoxygenAwesomeInteractiveToc.init()
        DoxygenAwesomeTabs.init()
    </script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-tabs.js" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
    <!-- https://tholman.com/github-corners/ -->
    <a href="https://github.com/netspeak/netspeak4-application-ngrams" class="github-corner"
        title="View source on GitHub" target="_blank" rel="noopener noreferrer">
        <svg viewBox="0 0 250 250" width="40" height="40"
            style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
            <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
            <path
                d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
                fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
            <path
                d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
                fill="currentColor" class="octo-body"></path>
        </svg></a>
    <style>
        .github-corner:hover .octo-arm {
            animation: octocat-wave 560ms ease-in-out
        }
        @keyframes octocat-wave {
            0%,
            100% {
                transform: rotate(0)
            }
            20%,
            60% {
                transform: rotate(-25deg)
            }
            40%,
            80% {
                transform: rotate(10deg)
            }
        }
        @media (max-width:500px) {
            .github-corner:hover .octo-arm {
                animation: none
            }
            .github-corner .octo-arm {
                animation: octocat-wave 560ms ease-in-out
            }
        }
    </style>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
        <div id="titlearea">
            <table cellspacing="0" cellpadding="0">
                <tbody>
                    <tr style="height: 56px;">
                        <td id="projectlogo"><img alt="Logo" src="netspeak_logo.svg" /></td>
                        <td id="projectalign" style="padding-left: 0.5em;">
                            <div id="projectname">Netspeak
                                &#160;<span
                                    id="projectnumber">5.0.0</span>
                            </div>
                            <div id="projectbrief">One word leads to another.</div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <!-- end header part --><!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('specification.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Specification</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md25">Netspeak query language</a></li>
<li class="level1"><a href="#autotoc_md26">Index configuration files</a><ul><li class="level2"><a href="#autotoc_md27">Metadata</a></li>
<li class="level2"><a href="#autotoc_md28">Performance</a></li>
<li class="level2"><a href="#autotoc_md29">Paths</a></li>
<li class="level2"><a href="#autotoc_md30">Casing</a></li>
<li class="level2"><a href="#autotoc_md31">Other</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md32">Logging</a><ul><li class="level2"><a href="#autotoc_md33">Tracking ID</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="autotoc_md25"></a>
Netspeak query language</h1>
<p>The Netspeak query syntax as described here should be used as reference. There might be other syntax information out there, e.g. at netspeak.org, which provides some syntactical simplifications in form of easier to use wildcards or operators. However, these modified syntaxes are just front-ends and do not work with the original Netspeak interface. Here is the truth:</p>
<div class="fragment"><div class="line">?   is a placeholder for exactly one word and can be sequenced to search for</div>
<div class="line">    exaclty two, three, four ... words.</div>
<div class="line"> </div>
<div class="line">    Example:    how to ? this</div>
<div class="line">                -&gt; how to use this</div>
<div class="line">                -&gt; how to do this</div>
<div class="line">                -&gt; how to cite this</div>
<div class="line"> </div>
<div class="line">*   is a placeholder for zero or many words.</div>
<div class="line"> </div>
<div class="line">    Example:    see * works</div>
<div class="line">                -&gt; see how it works</div>
<div class="line">                -&gt; see if it works</div>
<div class="line">                -&gt; see what works</div>
<div class="line"> </div>
<div class="line">[]  compares options, i.e. it checks each word or phrase between these</div>
<div class="line">    brackets plus the so called empty word at that position in the query.</div>
<div class="line"> </div>
<div class="line">    Example:    it&#39;s [ great well &quot;so good&quot; ]</div>
<div class="line">                -&gt; it&#39;s</div>
<div class="line">                -&gt; it&#39;s great</div>
<div class="line">                -&gt; it&#39;s well</div>
<div class="line">                -&gt; it&#39;s so good</div>
<div class="line"> </div>
<div class="line">{}  checks the order, i.e. it tries to find each permutation of the given</div>
<div class="line">    sequence of words or phrases at that position in the query.</div>
<div class="line"> </div>
<div class="line">    Example:    for { &quot;very important people&quot; only }</div>
<div class="line">                -&gt; for very important people only</div>
<div class="line">                -&gt; for only very important people</div>
<div class="line"> </div>
<div class="line">#   searches for alternatives of the word following. This operator requests</div>
<div class="line">    the optional Netspeak hash-dictionary component and uses [] to compare</div>
<div class="line">    each retrieved alternative (except that the empty word is not checked).</div>
<div class="line">    The mapping from word to alternatives is completely up to the user when</div>
<div class="line">    building Netspeak, for netspeak.org we use this operator for a synonym</div>
<div class="line">    search providing the Wordnet dictionary.</div>
<div class="line"> </div>
<div class="line">    Example:    waiting for #response</div>
<div class="line">                -&gt; waiting for response</div>
<div class="line">                -&gt; waiting for answer</div>
<div class="line">                -&gt; waiting for reply</div>
</div><!-- fragment --><p>You can combine the introduced wildcards and operators as you want, but with the exception that you may not place any wildcard within bracket operators. Also nested brackets are not allowed. As you can see in the examples above you can quote phrases to be handled as one entity is <code>[]</code> and <code>{}</code>.</p>
<h1><a class="anchor" id="autotoc_md26"></a>
Index configuration files</h1>
<p>Netspeak loads indexes using configuration files. These are small <code>.properties</code> files that contain information about the location and directory structure of the index, metadata (like name and language), and runtime parameters like the cache size.</p>
<p>The following section will explain all supported keys.</p>
<h2><a class="anchor" id="autotoc_md27"></a>
Metadata</h2>
<p>The following keys hold metadata about the corpus used to create the current index.</p>
<ul>
<li><p class="startli"><code>corpus.key = string</code> _(required)_</p>
<p class="startli">A unique key to identify the corpus. Two corpora with the same key are always assumed to be equal.</p>
</li>
<li><p class="startli"><code>corpus.name = string</code> _(required)_</p>
<p class="startli">The human-readable name of the corpus.</p>
</li>
<li><p class="startli"><code>corpus.language = string</code> _(required)_</p>
<p class="startli">The <a href="https://en.wikipedia.org/wiki/ISO_639-1">ISO 639-1 code</a> of the language of the corpus.</p>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md28"></a>
Performance</h2>
<p>The following keys are parameters used to fine-tune performance.</p>
<ul>
<li><p class="startli"><code>cache.capacity = size_t</code> _(optional)_</p>
<p class="startli">This sets the capacity of Netspeak's main cache: the norm query cache. This LFU cache stores the outputs of the query processor. It has a static capacity that limits the maximum number of items.</p>
<p class="startli">The default cache capacity of the current implementation is 1 million. At this capacity, an empty cache will use about 100MB and a full cache will use about 3GB of memory (depends on the cached queries). Other implementation may use different defaults.</p>
</li>
<li><p class="startli"><code>search.max-norm-queries = uint32</code> _(optional)_</p>
<p class="startli">The maximum number of norm queries the queries normalizer is allowed to create.</p>
<p class="startli">Norm queries are the fundamental query units of Netspeak. Each norm queries (if not cached) requires at least one random IO access. The maximum should be chosen with regards to hardware the index is stored on. A maximum of &lt;=1000 for HDDs and ~10k for SDDs is recommended.</p>
<p class="startli">Choosing a large maximum can cause queries containing regexes and synonyms to become very slow (seconds per query; uncached).</p>
<p class="startli">The default is implementation defined. The current implementation has a default of 1000.</p>
</li>
<li><p class="startli"><code>search.regex.max-matches = uint32</code> _(optional)_</p>
<p class="startli">The maximum number of regex matches. The current implementation replaces regex queries with a set of matching words (e.g. <code>route?</code> may be replaced with <code>[ router routed ]</code>). This parameter sets the maximum amount of words each regex query can be replaced with.</p>
<p class="startli">Choosing a large maximum can cause queries containing regexes to become very slow. This is only a maximum and the implementation may choose to use fewer words to (hopefully) stay fast.</p>
<p class="startli">You can set this to 0 to disable regex queries.</p>
<p class="startli">The default is implementation defined. The current implementation has a default of 100.</p>
</li>
<li><p class="startli"><code>search.regex.max-time = uint32</code> _(optional)_</p>
<p class="startli">The maximum amount of time in milliseconds Netspeak is allowed to search for regex matches. Choosing a generous duration will lead to more accurate search results but may degrade performance.</p>
<p class="startli">The default is implementation-defined but will generally around be a few milliseconds.</p>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md29"></a>
Paths</h2>
<p>The following keys are paths to locate the index.</p>
<ul>
<li><p class="startli"><code>path.to.phrase-index = path</code> _(optional)_ <br  />
 <code>path.to.phrase-corpus = path</code> _(optional)_ <br  />
 <code>path.to.phrase-dictionary = path</code> _(optional)_ <br  />
 <code>path.to.postlist-index = path</code> _(optional)_ <br  />
 <code>path.to.hash-dictionary = path</code> _(optional)_ <br  />
 <code>path.to.regex-vocabulary = path</code> _(optional)_ <br  />
</p>
<p class="startli">Paths to the individual components of a Netspeak index.</p>
</li>
<li><p class="startli"><code>path.to.home = path</code> _(optional)_</p>
<p class="startli">This will set all unset <code>path.to.xxxx</code> values to <code>&lt;path.to.home&gt;/xxxx</code>.</p>
<p class="startli">If a Netspeak index follows the default index format (all indexes created by Netspeak do), then <code>path.to.home</code> can be used to set all index paths at once.</p>
<p class="startli">Note: "unset" means not present in this configuration file. Keys from the <code>extends</code> file are not considered.</p>
</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>All paths (if not absolute) are relative to the directory the configuration file lives in.</dd></dl>
<h2><a class="anchor" id="autotoc_md30"></a>
Casing</h2>
<ul>
<li><p class="startli"><code>query.lower-case = bool</code> _(optional)_</p>
<p class="startli">Whether all queries will be lower-cased. This option is useful if the index only contains lower-case phrases.</p>
<p class="startli">The default is <code>false</code>.</p>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md31"></a>
Other</h2>
<ul>
<li><p class="startli"><code>extends = path</code> _(optional)_</p>
<p class="startli">The path of another configuration files.</p>
<p class="startli">All keys that are not present in the current configuration file will be retrieved from this one instead. This can be used to implement inheritance.</p>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md32"></a>
Logging</h1>
<p>The <code>serve</code> and <code>proxy</code> sub-command both support logging. This means that they will log every request they receive and every error produced.</p>
<h2><a class="anchor" id="autotoc_md33"></a>
Tracking ID</h2>
<p>Tracking is implemented via optional client metadata. Clients can provide a number to track their session to help improve the service.</p>
<p>The tracking number has to be provided as client metadata using the key <code>netspeak-tracking-id</code>. The value of that key has to be a 128bit hexadecimal number matching the following regex: <code>^[0-9A-Fa-f]{32}$</code>.</p>
<p>There are no requirements for the actual number but it is recommended for them to be randomly generated. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="DeveloperIdx.html">For Developers</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
